#!/bin/bash
OUTPUT=`sudo subscription-manager list --consumed | grep -i 'active\|subscription name' | cut -d ':' -f2 | awk '{$1=$1};1' | awk '{printf "%s|",$0} END {print ""}' | sed -e 's/ /_/g'`

SUB_COUNTER=0

if [ -z "$OUTPUT" ]; then
  echo "No subscriptions found"
  exit
else
  echo "[rhn-subscriptions-consumed]"
  for SUB in $OUTPUT;
    do
      ((SUB_COUNTER++))
      echo "subscription_$SUB_COUNTER=$SUB";
    done
fi